$(document).ready(function(){function t(t,e){var n=$(e),a=new Image;a.onload=function(){n.attr("src",a.src),i()},a.src=n.attr("preload-src")}function e(){$("img[preload-src]").map(t)}function n(){$(".carousel .item").each(function(){var t=$(this);t.css("width",t.closest(".carousel").width()+"px").css("float","left").css("position","absolute")})}function i(){for(var t=$(".carousel .carousel-inner"),e=$(".carousel .item"),n=0,i=0;i<e.length;i++)n<$(e[i]).height()&&(n=$(e[i]).height());t.height(n+"px")}function a(){e(),n()}function c(){var t=!1;$(document).on("click",".carousel .nav-bar .prev",function(){if(!t){t=!0;var e=$(this).closest(".carousel"),n=e.find(".item.active"),i=n.prev(".item");i.addClass("active").css("margin-left","-100%"),i.length<=0&&(i=e.find(".item").last(),i.addClass("active").css("margin-left","-200%")),n.animate({"margin-left":"100%"},function(){n.removeClass("active"),n.css("margin-left",0),i.animate({"margin-left":0},function(){t=!1})})}}),$(document).on("click",".carousel .nav-bar .next",function(){if(!t){t=!0;var e=$(this).closest(".carousel"),n=e.find(".item.active"),i=n.next(".item");i.length<=0&&(i=e.find(".item:first-child")),i.addClass("active").css("margin-left","100%"),n.animate({"margin-left":"-100%"},function(){n.removeClass("active"),n.css("margin-left",0),i.animate({"margin-left":0},function(){t=!1})})}})}c(),a(),$(document).on("pjax/done",function(){setTimeout(a,100)}),$(window).on("resize",n)});
$(function(){function n(){for(var n=document.getElementsByClassName("clamp"),o=0;o<n.length;o++){var e=n[o];$clamp(e,{clamp:5})}}n(),$(document).on("pjax/done",n).on("show_content",n)});
!function(){function o(o,n){$(o).children().each(function(){var o=$(this);o.attr("data-group")&&o.attr("data-group")!==n?o.hide():o.show()})}function n(o){var n=o.find("video");n.length&&n.each(function(o,n){n.pause()})}function t(o){o.removeClass("show"),n(o)}$(document).on("show_content",function(n,t,a){o(".group-description",a),o(".carousel-items",a),o(".services",a)}).on("click",".mask .close.button",function(){t($(this).closest(".mask"))}).on("click",".mask .shadow-box",function(o){o.stopPropagation()}).on("click",".mask",function(){t($(this))}).on("keydown",function(o){27===o.keyCode&&t($(".mask.show"))}).on("click","[data-modal-selector]",function(o){$($(this).attr("data-modal-selector")).addClass("show"),o.stopPropagation(),n($(".ui.embed"))})}();
$(function(){function o(){$(".owl-carousel").owlCarousel({items:1,lazyLoad:!0,loop:!0,autoplayTimeout:8e3,autoplayHoverPause:!0,nav:!0,navRewind:!0,smartSpeed:500,navText:["<i>&lt;</i>","<i>&gt;</i>"],autoHeight:!0})}function e(){var o=$(".body"),e=$("body");console.log("resizing footer body");var t=e.height();console.log("total = ",t);var n=$(".to-top").outerHeight();console.log("top = ",n);var i=$("#footer").outerHeight();console.log("footer = ",i);var l=t-n-i;console.log("body height = ",l),o.height(l)}$(window).on("resize",function(){console.log("action when resize"),e(),setTimeout(o,500)}),$(document).on("pjax/done",function(){console.log("action when pjax/done"),setTimeout(o,500)}).on("show_content",function(){console.log("action when show_content"),e(),setTimeout(o,500)}),$(".to-top, #footer").find("img").each(function(o,t){console.log("img load, changed height"),$(t).on("load",e)})});
var vmvideos=[{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_1.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_2.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_3.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_4.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_5.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_6.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_7.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_8.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_9.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_10.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_1.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_2.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_3.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_4.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_5.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_6.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_7.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_8.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_9.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_10.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_1.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_2.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_3.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_4.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_5.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_6.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_7.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_8.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_9.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_10.jpg"}],additionInfo=[[{url:"/bower/bridgeplus_ui/public/images/CORPORATE_PG.png",width:460,height:102,x:600,y:120},{url:"/bower/bridgeplus_ui/public/images/CORPORATE.png",width:123,height:41,x:739,y:220}],[{url:"/bower/bridgeplus_ui/public/images/MENTOR_PG.png",width:245,height:183,x:677.5,y:110},{url:"/bower/bridgeplus_ui/public/images/MENTOR.png",width:123,height:41,x:739,y:290}],[{url:"/bower/bridgeplus_ui/public/images/STUDENT_PG.png",width:446,height:207,x:620,y:200},{url:"/bower/bridgeplus_ui/public/images/STUDENT.png",width:123,height:41,x:739,y:360}]];
$(function(){function t(){r.currentW=$(window).width(),r.currentH=$(window).height(),o=.5*r.currentW,i=.5*r.currentH}function n(){var t,n=$("#bridge_plus_wheel svg");if(n.length){t=r.currentH<760?r.currentH/760:1;var e="scale3d("+t+","+t+",1)",o={"-webkit-transform":e,"-moz-transform":e,"-ms-transform":e,transform:e};n.css(o),$("#logo").css(o)}}function e(t){var n=[];return t.classList&&"function"==typeof t.classList.forEach?t.classList.forEach(function(t){n.push(t)}):n=(t.getAttribute("class")||"").split(" "),n}var o,i,r={currentW:0,currentH:0};!function(){function t(){function t(){var n=c.clone().attr({r:u,opacity:0,fill:"none","stroke-width":1});n.attr({opacity:1}).animate({r:u+10,"stroke-width":41,stroke:"#FFF"},1e3,">",function(){}),u+=40,o+150>u?setTimeout(t,50):($("#logo").addClass("active"),$(".logo_top").addClass("active"),setTimeout(function(){BridgeWheel.start(),s.addClass("active"),$("#bridge_plus_intro").hide()},1e3))}var n=this.intro=new Raphael("bridge_plus_intro",r.currentW,r.currentH),a=n.path("M 0,"+r.currentH+" L 0,"+r.currentH).attr({fill:"#E71E30",stroke:"#E71E30","stroke-width":4}),c=n.circle(o,i,0).attr({fill:"#111",stroke:"#111"});a.animate({path:"M 0,"+r.currentH+" L "+o+","+i},1e3,">",function(){e.arcouno(),a.animate({path:"M "+o+","+i+"L "+o+","+i},1e3,">",function(){}),c.animate({r:"72"},1800,">",function(){}),setTimeout(t,1100)});var u=0}function n(){var t=e.intro.path(e.arc([o,i],120,120,320)).attr({stroke:"#111","stroke-width":1});t.attr({transform:"r0,"+o+","+i}).animate({transform:"r360,"+o+","+i},4e3)}var e=window.INTRO={intro:null,init:t,arcouno:n,arc:function(t,n,e,o){for(var i=e,r=this.toCoords(t,n,i),a="M "+r[0]+" "+r[1];o>=i;)r=this.toCoords(t,n,i),a+=" L "+r[0]+" "+r[1],i++;return a},toCoords:function(t,n,e){var o=e/180*Math.PI,i=t[0]+Math.cos(o)*n,r=t[1]+Math.sin(o)*n;return[i,r]}}}(),function(){var t=window.BridgeWheel={first:!0,sourceArr:[],imgAll:[],init:function(){this.first&&(this.first=!1,INTRO.init())},start:function(){var n=new Raphael("bridge_plus_wheel",1600,1e3);t.resize(),n.wheel(440,vmvideos.slice(0,10),2,vmvideos,[],additionInfo)},resize:n}}();var a=$(".wheel_text"),s=$(".main_page_wheel"),c=$(".main_page_bottom"),u=$(".main_page_right");$(document).on("wheel/show",function(){$(".svg_group").hover(function(){$(document).trigger("show_group_desc",e(this))},function(){$(document).trigger("hide_group_desc",e(this))}).on("click",function(){var t,n=e(this);n.indexOf("svg_group_0")>=0&&(t="/portal/zh/student-portal"),n.indexOf("svg_group_1")>=0&&(t="/portal/zh/mentor-portal"),n.indexOf("svg_group_2")>=0&&(t="/portal/zh/hr-portal"),$(document).trigger("navigate",t)})}).on("click",".logo_right",function(){$(document).trigger("show_right")}).on("show_group_desc",function(t,n,e){a.hide().each(function(){$(this).hasClass(e)&&$(this).show()})}).on("hide_group_desc",function(t,n,e){a.each(function(){$(this).hasClass(e)&&$(this).hide()})}).on("show_wheel",function(){s.animate({top:0,left:0},500),c.animate({top:"100%",left:0},500),u.animate({left:"100%"},500),BridgeWheel.init()}).on("show_content",function(){return"/"===location.pathname?void $(document).trigger("show_wheel"):(s.animate({top:"-100%",left:0},500),c.animate({top:0,left:0},500),void u.animate({left:"100%"},500))}).on("show_right",function(){s.animate({left:"-100%"},500),c.animate({left:"-100%"},500),u.animate({left:0},500)}).on("pjax/done",document,function(){$(document).trigger("show_content",null)}),$(window).on("resize",function(){t(),BridgeWheel.resize()}),t(),"/"==location.pathname?BridgeWheel.init():$(document).trigger("show_content")});
$(document).ready(function(){var e=!1;$(".menu-button").click(function(){e?$(".menu").removeClass("active"):$(".menu").addClass("active"),e=!e}),$(document).on("show_right",function(){$("#pic-entrance").addClass("active")}).on("show_wheel",function(){$("#pic-entrance").removeClass("active")}).on("click",".left-arrow",function(){$(document).trigger("show_wheel")})});
!function(){function n(n,t,e,o,i){if(m.indexOf(n)>=0&&m.indexOf(t)>=0)return o;var r=d.indexOf(n),a=d.indexOf(t);return 0>r||0>a||r===a?e:a>r?o:i}function t(n){n.addClass("slide-to-left"),o(n)}function e(n){return n.animate({left:"0",right:"0"},"slow",function(){n.css("position","relative")}).promise()}function o(n){n.bind(s,function(){n.remove()})}function i(n){n.addClass("slide-to-right"),o(n)}function r(n,t){var e=document.createElement("div");e.innerHTML=n.innerHTML;var o=$(e),i=$(n);o.css({position:"absolute",left:"0",right:"0",height:i.height()+"px","background-color":i.css("background-color")}),o.insertBefore(i),t&&t(o,i)}function a(){$("#footer").css("position","fixed")}function c(){setTimeout(function(){$("#footer").css("position","relative")},f)}function u(n,e){a(),t(e),n.addClass("return-to-origin-from-right"),n.bind(s,function(){n.removeClass("return-to-origin-from-right")}),c()}function l(n,t){a(),i(t),n.addClass("return-to-origin-from-left"),n.bind(s,function(){n.removeClass("return-to-origin-from-left")}),c()}var f=1e3,s="oanimationend animationend webkitAnimationEnd",d=["/portal/zh/about-us","/portal/zh/team","/portal/zh/video","/portal/zh/contact-us","/portal/zh/join-us"],m=["/portal/zh/student-portal","/portal/zh/mentor-portal","/portal/zh/hr-portal"];window.animationDirector={returnToOriginalPos:e,cloneOldSlide:r,getAnimation:n,slideToLeft:u,slideToRight:l}}(),$(function(){function n(n,t){n.push(t),n.length>5&&n.shift()}function t(n,t,e){o(t,e,function(){f.classList.add("hide"),setTimeout(function(){f.innerHTML=n,f.classList.remove("hide")},100)})}function e(){f=f||document.querySelector(".body"),s=s||document.querySelector("title")}function o(n,t,o){$(document).trigger("pjax/refresh"),e(),o(),r(t,n),$(document).trigger("pjax/done"),console.log("pjax/done")}function i(n,t,e){o(t,e,function(){animationDirector.cloneOldSlide(f,function(t,e){f.innerHTML=n,animationDirector.slideToLeft(e,t)})})}function r(n,t){Object.keys(n).forEach(function(t){f.setAttribute("data-"+t,n[t])}),s&&(s.innerHTML=t)}function a(n,t,e){o(t,e,function(){animationDirector.cloneOldSlide(f,function(t,e){f.innerHTML=n,v(e,t)})})}function c(n){for(var t={},e=n.length-1;e>=0;e--){var o=n[e];0==o.name.indexOf("data-")&&(t[o.name.slice(5)]=o.value)}return t}function u(n,t){console.log("getting ",n),0===n.indexOf("/")&&n.indexOf("//")<0&&(n=location.origin+n),p[n]?(console.log("from cache"),t(p[n])):(console.log("from server"),$.get(n,function(e){p[n]=e,t(e)}))}function l(e,o,i,r){$(document).trigger("pjax/start"),u(e,function(a){f=f||document.querySelector(".body"),s=s||document.querySelector("title"),d.innerHTML=a,i&&(history.pushState(e,"",e),n(m,f.innerHTML),n(g,c(f.attributes)),s&&n(h,s.innerHTML));var u=d.querySelector(".body"),l=d.querySelector("title");(r=r||t)(u.innerHTML,l&&l.innerHTML,c(u.attributes),o)})}var f,s,d=document.createElement("DIV"),m=[],g=[],h=[],p={};document.addEventListener("click",function(n){var e=n.target;if("A"!==e.nodeName){if(e=$(e).closest("a"),!e.length)return!0;e=e[0]}var o=e.href?e.href.toLowerCase():"";return"false"!==e.getAttribute("use-pjax")&&o.length&&"#"!=o.charAt(0)&&0!=o.indexOf("mailto:")&&0!=o.indexOf("javascript:")?(n.preventDefault(),n.stopPropagation(),void l(o,e,!0,animationDirector.getAnimation(location.pathname,e.pathname,t,i,a))):!0},!1),window.addEventListener("popstate",function(){return m&&m.length?void t(m.pop(),h.pop(),g.pop()):void l(location.href)}),$(document).on("navigate",function(n,t){l(t,null,!0)});var v=animationDirector.slideToRight});
Raphael.fn.group=function(t,a){var r=document.createElementNS("http://www.w3.org/2000/svg","g");if(r.style&&(r.style.webkitTapHighlightColor="rgba(0,0,0,0)"),r.classList)r.classList.add("svg_group"),r.classList.add(a);else{var n=(r.getAttribute("class")||"").split(" "),e=!1;-1==n.indexOf("svg_group")&&(n.push("svg_group"),e=!0),-1==n.indexOf(a)&&(n.push(a),e=!0),e&&r.setAttribute("class",n.join(" "))}if(t)for(var o=0,i=t.length;i>o;o++)r.appendChild(t[o].node);return this.canvas.appendChild(r),r},Raphael.fn.wheel=function(t,a,r,n,e,o){function i(){var t=g.image(this.src,690,y,E,L).attr({opacity:0});v.push(t),++m==d&&l()}function c(){var t=g.image("http://vlog.it/img/placeholder.jpg",690,y,E,L).attr({opacity:0});t.node.id=this.id,v.push(t),++m==d&&l()}function s(t,a){var r="M,800,500,L,862.3735072453278,206.5557197798583,A,300,300,0,0,0,737.6264927546722,206.5557197798583,z",r="M,800,500,L,855.1248553449711, 205.1080700948295,A,300,300,0,0,0,744.8751446550289, 205.1080700948295,z",r="M,800,500,L,892.7050983124842, 214.68304511145396,A,300,300,0,0,0,707.2949016875158, 214.68304511145396,z",n="M,800,500,L,844.8707740637095,274.419385507257,A,230,230,0,0,0,755.1292259362905,274.419385507257,z",n="M,800,500,L,871.073908706238, 281.2570012521147,A,230,230,0,0,0,728.926091293762, 281.2570012521147,z",e="M,800,500,L,835.6033494330103,344.0115340509082,A,160,160,0,0,0,764.3966505669897,344.0115340509082,z",e="M,800,500,L,849.4427190999916, 347.8309573927754,A,160,160,0,0,0,750.5572809000084, 347.8309573927754,z",o=[g.path(e).attr({stroke:"none"}),g.path(n).attr({stroke:"none"}),g.path(r).attr({stroke:"none"})],i=document.createElementNS(A,"clipPath");i.setAttribute("id","clip_ring"+t),i.appendChild(o[t].node),g.canvas.appendChild(i),a.forEach(function(a,r){var n=w*r;a.rotate(n,800,500),a.node.setAttribute("clip-path","url(#clip_ring"+t+")"),a.node.style.cursor="pointer",a.attr({opacity:0}),h(a,w,r)})}function h(t,a,r){t.attr({transform:"r"+a*r+",800,500t0,140"})}function l(){var t=[];o[o.length-(r+1)].forEach(function(a){var r=g.image(a.url,a.x,a.y,a.width,a.height).attr({opacity:1});r.node.classList.add("svg_group_addtion"),t.push(r)});var a;switch(r){case 2:a=300;break;case 1:a=230;break;case 0:a=160}var i=(a-100)/a;i=(100*i|0)/100;var c=g.circle(800,500,a).attr({fill:"#000",stroke:"none"});c.node.style.transform="scale("+i+","+i+")",g.group([t[0]].concat(v,c,t[1]),"svg_group_"+r),s(r,v),e.push(v),2==r?g.wheel(340,n.slice(10,20),1,n,e,o):1==r?g.wheel(240,n.slice(20,30),0,n,e,o):(u(),$(document).trigger("wheel/show"))}function u(){var t=36,a=e[2],r=a.length;a.forEach(function(n,e){e==r-1?n.attr({opacity:1}).animate({transform:"r"+t*e+",800,500t0,0"},1e3,"<>",function(){f(),a.forEach(function(a,r){a.animate({transform:"r"+(360+t*r)+",800,500"},3e4)})}):n.attr({opacity:1}).animate({transform:"r"+t*e+",800,500t0,0"},1e3,"<>",function(){})})}function f(){var t=36,a=e[1],r=a.length;a.forEach(function(n,e){n.attr({opacity:1}).animate({transform:"r"+t*e+",800,500t0,0"},1e3,"<>",function(){e==r-1&&(p(),a.forEach(function(a,r){a.animate({transform:"r"+(-360+t*r)+",800,500"},3e4)}))})})}function p(){var t=e[0],a=t.length,r=36;t.forEach(function(n,e){n.attr({opacity:1}).animate({transform:"r"+r*e+",800,500t0,0"},1e3,"<",function(){e==a-1&&t.forEach(function(t,a){t.animate({transform:"r"+(360+r*a)+",800,500"},3e4)})})})}var g=this,d=a.length,m=0,v=[],w=360/d,y=340-70*r,A="http://www.w3.org/2000/svg",E=210,L=100;a.forEach(function(t){var a=new Image;a.onload=i,a.onerror=c,a.src=t.thumb,a.id=t.url,a.title=t.title,a.author=t.author})};