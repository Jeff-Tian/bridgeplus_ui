$(document).ready(function(){function t(t,e){var n=$(e),a=new Image;a.onload=function(){n.attr("src",a.src),i()},a.src=n.attr("preload-src")}function e(){$("img[preload-src]").map(t)}function n(){$(".carousel .item").each(function(){var t=$(this);t.css("width",t.closest(".carousel").width()+"px").css("float","left").css("position","absolute")})}function i(){for(var t=$(".carousel .carousel-inner"),e=$(".carousel .item"),n=0,i=0;i<e.length;i++)n<$(e[i]).height()&&(n=$(e[i]).height());t.height(n+"px")}function a(){e(),n()}function c(){var t=!1;$(document).on("click",".carousel .nav-bar .prev",function(){if(!t){t=!0;var e=$(this).closest(".carousel"),n=e.find(".item.active"),i=n.prev(".item");i.addClass("active").css("margin-left","-100%"),i.length<=0&&(i=e.find(".item").last(),i.addClass("active").css("margin-left","-200%")),n.animate({"margin-left":"100%"},function(){n.removeClass("active"),n.css("margin-left",0),i.animate({"margin-left":0},function(){t=!1})})}}),$(document).on("click",".carousel .nav-bar .next",function(){if(!t){t=!0;var e=$(this).closest(".carousel"),n=e.find(".item.active"),i=n.next(".item");i.length<=0&&(i=e.find(".item:first-child")),i.addClass("active").css("margin-left","100%"),n.animate({"margin-left":"-100%"},function(){n.removeClass("active"),n.css("margin-left",0),i.animate({"margin-left":0},function(){t=!1})})}})}c(),a(),$(document).on("pjax/done",function(){setTimeout(a,100)}),$(window).on("resize",n)});
$(function(){function n(){for(var n=document.getElementsByClassName("clamp"),o=0;o<n.length;o++){var e=n[o];$clamp(e,{clamp:5})}}n(),$(document).on("pjax/done",n).on("show_content",n)});
!function(){function o(o,n){$(o).children().each(function(){var o=$(this);o.attr("data-group")&&o.attr("data-group")!==n?o.hide():o.show()})}function n(o){var n=o.find("video");n.length&&n.each(function(o,n){n.pause()})}function t(o){o.removeClass("show"),n(o)}$(document).on("show_content",function(n,t,a){o(".group-description",a),o(".carousel-items",a),o(".services",a)}).on("click",".mask .close.button",function(){t($(this).closest(".mask"))}).on("click",".mask .shadow-box",function(o){o.stopPropagation()}).on("click",".mask",function(){t($(this))}).on("keydown",function(o){27===o.keyCode&&t($(".mask.show"))}).on("click","[data-modal-selector]",function(o){$($(this).attr("data-modal-selector")).addClass("show"),o.stopPropagation(),n($(".ui.embed"))})}();
$(function(){function r(r){return $('.popup[for="'+$(r.currentTarget).attr("id")+'"]')}var t=function(t){return function(n){var e=r(n);e[t]("active")}};$(".popup-trigger").hover(t("addClass"),t("removeClass"))});
$(function(){function o(){$(".owl-carousel").owlCarousel({items:1,lazyLoad:!0,loop:!0,autoplayTimeout:8e3,autoplayHoverPause:!0,nav:!0,navRewind:!0,smartSpeed:500,navText:["<i>&lt;</i>","<i>&gt;</i>"],autoHeight:!0})}function e(){var o=$(".body"),e=$("body");console.log("resizing footer body");var t=e.height();console.log("total = ",t);var n=$(".to-top").outerHeight();console.log("top = ",n);var i=$("#footer").outerHeight();console.log("footer = ",i);var l=t-n-i;console.log("body height = ",l),o.height(l)}$(window).on("resize",function(){console.log("action when resize"),e(),setTimeout(o,500)}),$(document).on("pjax/done",function(){console.log("action when pjax/done"),setTimeout(o,500)}).on("show_content",function(){console.log("action when show_content"),e(),setTimeout(o,500)}),$(".to-top, #footer").find("img").each(function(o,t){console.log("img load, changed height"),$(t).on("load",e)})});

$(function(){function t(){r.currentW=$(window).width(),r.currentH=$(window).height(),o=.5*r.currentW,i=.5*r.currentH}function n(){var t,n=$("#bridge_plus_wheel svg");if(n.length){t=r.currentH<760?r.currentH/760:1;var e="scale3d("+t+","+t+",1)",o={"-webkit-transform":e,"-moz-transform":e,"-ms-transform":e,transform:e};n.css(o),$("#logo").css(o)}}function e(t){var n=[];return t.classList&&"function"==typeof t.classList.forEach?t.classList.forEach(function(t){n.push(t)}):n=(t.getAttribute("class")||"").split(" "),n}var o,i,r={currentW:0,currentH:0};!function(){function t(){function t(){var n=c.clone().attr({r:u,opacity:0,fill:"none","stroke-width":1});n.attr({opacity:1}).animate({r:u+10,"stroke-width":41,stroke:"#FFF"},1e3,">",function(){}),u+=40,u<o+150?setTimeout(t,50):($("#logo").addClass("active"),$(".logo_top").addClass("active"),setTimeout(function(){BridgeWheel.start(),s.addClass("active"),$("#bridge_plus_intro").hide()},1e3))}var n=this.intro=new Raphael("bridge_plus_intro",r.currentW,r.currentH),a=n.path("M 0,"+r.currentH+" L 0,"+r.currentH).attr({fill:"#E71E30",stroke:"#E71E30","stroke-width":4}),c=n.circle(o,i,0).attr({fill:"#111",stroke:"#111"});a.animate({path:"M 0,"+r.currentH+" L "+o+","+i},1e3,">",function(){e.arcouno(),a.animate({path:"M "+o+","+i+"L "+o+","+i},1e3,">",function(){}),c.animate({r:"72"},1800,">",function(){}),setTimeout(t,1100)});var u=0}function n(){var t=e.intro.path(e.arc([o,i],120,120,320)).attr({stroke:"#111","stroke-width":1});t.attr({transform:"r0,"+o+","+i}).animate({transform:"r360,"+o+","+i},4e3)}var e=window.INTRO={intro:null,init:t,arcouno:n,arc:function(t,n,e,o){for(var i=e,r=this.toCoords(t,n,i),a="M "+r[0]+" "+r[1];o>=i;)r=this.toCoords(t,n,i),a+=" L "+r[0]+" "+r[1],i++;return a},toCoords:function(t,n,e){var o=e/180*Math.PI,i=t[0]+Math.cos(o)*n,r=t[1]+Math.sin(o)*n;return[i,r]}}}(),function(){window.BridgeWheel={first:!0,sourceArr:[],imgAll:[],init:function(){this.first&&(this.first=!1,INTRO.init())},start:function(){var t=new Raphael("bridge_plus_wheel",1600,1e3);this.resize(),setTimeout(function(){t.wheel()},500)},resize:n}}();var a=$(".wheel_text"),s=$(".main_page_wheel"),c=$(".main_page_bottom"),u=$(".main_page_right");$(document).on("wheel/show",function(){$(".svg_group").hover(function(){$(document).trigger("show_group_desc",e(this))},function(){$(document).trigger("hide_group_desc",e(this))}).on("click",function(){var t,n=e(this);n.indexOf("svg_group_0")>=0&&(t="/portal/zh/student-portal"),n.indexOf("svg_group_1")>=0&&(t="/portal/zh/mentor-portal"),n.indexOf("svg_group_2")>=0&&(t="/portal/zh/hr-portal"),$(document).trigger("navigate",t)})}).on("click",".logo_right",function(){$(document).trigger("show_right")}).on("show_group_desc",function(t,n,e){a.hide().each(function(){$(this).hasClass(e)&&$(this).show()})}).on("hide_group_desc",function(t,n,e){a.each(function(){$(this).hasClass(e)&&$(this).hide()})}).on("show_wheel",function(){s.animate({top:0,left:0},500),c.animate({top:"100%",left:0},500),u.animate({left:"100%"},500),BridgeWheel.init()}).on("show_content",function(){return"/"===location.pathname?void $(document).trigger("show_wheel"):(s.animate({top:"-100%",left:0},500),c.animate({top:0,left:0},500),void u.animate({left:"100%"},500))}).on("show_right",function(){s.animate({left:"-100%"},500),c.animate({left:"-100%"},500),u.animate({left:0},500)}).on("pjax/done",document,function(){$(document).trigger("show_content",null)}),$(window).on("resize",function(){t(),BridgeWheel.resize()}),t(),"/"==location.pathname?BridgeWheel.init():$(document).trigger("show_content")});
$(document).ready(function(){var e=!1;$(".menu-button").click(function(){e?($(".menu").removeClass("active"),$(".menu").addClass("normal")):($(".menu").addClass("active"),$(".menu").removeClass("normal")),e=!e}),$(document).on("show_right",function(){$("#pic-entrance").addClass("active")}).on("show_wheel",function(){$("#pic-entrance").removeClass("active")}).on("click",".left-arrow",function(){$(document).trigger("show_wheel")})});
!function(){function n(n,t,e,o,i){if(m.indexOf(n)>=0&&m.indexOf(t)>=0)return o;var r=d.indexOf(n),a=d.indexOf(t);return r<0||a<0||r===a?e:r<a?o:i}function t(n){n.addClass("slide-to-left"),o(n)}function e(n){return n.animate({left:"0",right:"0"},"slow",function(){n.css("position","relative")}).promise()}function o(n){n.bind(s,function(){n.remove()})}function i(n){n.addClass("slide-to-right"),o(n)}function r(n,t){var e=document.createElement("div");e.innerHTML=n.innerHTML;var o=$(e),i=$(n);o.css({position:"absolute",left:"0",right:"0",height:i.height()+"px","background-color":i.css("background-color")}),o.insertBefore(i),t&&t(o,i)}function a(){$("#footer").css("position","fixed")}function c(){setTimeout(function(){$("#footer").css("position","relative")},f)}function u(n,e){a(),t(e),n.addClass("return-to-origin-from-right"),n.bind(s,function(){n.removeClass("return-to-origin-from-right")}),c()}function l(n,t){a(),i(t),n.addClass("return-to-origin-from-left"),n.bind(s,function(){n.removeClass("return-to-origin-from-left")}),c()}var f=1e3,s="oanimationend animationend webkitAnimationEnd",d=["/portal/zh/about-us","/portal/zh/team","/portal/zh/video","/portal/zh/contact-us","/portal/zh/join-us"],m=["/portal/zh/student-portal","/portal/zh/mentor-portal","/portal/zh/hr-portal"];window.animationDirector={returnToOriginalPos:e,cloneOldSlide:r,getAnimation:n,slideToLeft:u,slideToRight:l}}(),$(function(){function n(n,t){n.push(t),n.length>5&&n.shift()}function t(n,t,e){o(t,e,function(){f.classList.add("hide"),setTimeout(function(){f.innerHTML=n,f.classList.remove("hide")},100)})}function e(){f=f||document.querySelector(".body"),s=s||document.querySelector("title")}function o(n,t,o){$(document).trigger("pjax/refresh"),e(),o(),r(t,n),$(document).trigger("pjax/done"),console.log("pjax/done")}function i(n,t,e){o(t,e,function(){animationDirector.cloneOldSlide(f,function(t,e){f.innerHTML=n,animationDirector.slideToLeft(e,t)})})}function r(n,t){Object.keys(n).forEach(function(t){f.setAttribute("data-"+t,n[t])}),s&&(s.innerHTML=t)}function a(n,t,e){o(t,e,function(){animationDirector.cloneOldSlide(f,function(t,e){f.innerHTML=n,v(e,t)})})}function c(n){for(var t={},e=n.length-1;e>=0;e--){var o=n[e];0==o.name.indexOf("data-")&&(t[o.name.slice(5)]=o.value)}return t}function u(n,t){console.log("getting ",n),0===n.indexOf("/")&&n.indexOf("//")<0&&(n=location.origin+n),p[n]?(console.log("from cache"),t(p[n])):(console.log("from server"),$.get(n,function(e){p[n]=e,t(e)}))}function l(e,o,i,r){$(document).trigger("pjax/start"),u(e,function(a){f=f||document.querySelector(".body"),s=s||document.querySelector("title"),d.innerHTML=a,i&&(history.pushState(e,"",e),n(m,f.innerHTML),n(g,c(f.attributes)),s&&n(h,s.innerHTML));var u=d.querySelector(".body"),l=d.querySelector("title");(r=r||t)(u.innerHTML,l&&l.innerHTML,c(u.attributes),o)})}var f,s,d=document.createElement("DIV"),m=[],g=[],h=[],p={};document.addEventListener("click",function(n){var e=n.target;if("A"!==e.nodeName){if(e=$(e).closest("a"),!e.length)return!0;e=e[0]}var o=e.href?e.href.toLowerCase():"";return"false"===e.getAttribute("use-pjax")||!o.length||"#"==o.charAt(0)||0==o.indexOf("mailto:")||0==o.indexOf("javascript:")||(n.preventDefault(),n.stopPropagation(),void l(o,e,!0,animationDirector.getAnimation(location.pathname,e.pathname,t,i,a)))},!1),window.addEventListener("popstate",function(){return m&&m.length?void t(m.pop(),h.pop(),g.pop()):void l(location.href)}),$(document).on("navigate",function(n,t){l(t,null,!0)});var v=animationDirector.slideToRight});
!function(){function e(e,t){var r;switch(t){case 0:r="M,800,500,L,849.4427190999916, 347.8309573927754,A,160,160,0,0,0,750.5572809000084, 347.8309573927754,z";break;case 1:r="M,800,500,L,871.073908706238, 281.2570012521147,A,230,230,0,0,0,728.926091293762, 281.2570012521147,z";break;case 2:r="M,800,500,L,892.7050983124842, 214.68304511145396,A,300,300,0,0,0,707.2949016875158, 214.68304511145396,z"}return e.path(r).attr({stroke:"none"})}function t(e,t){if(e.classList)e.classList.add(t);else{var r=(e.getAttribute("class")||"").split(" ");r.indexOf(t)==-1&&(r.push(t),e.setAttribute("class",r.join(" ")))}}function r(e,t,r){e.attr({transform:"r"+t*r+",800,500t0,140"})}function n(e,t,r,n){function o(){var t=e.image(this.src,690,340-70*r,s,u).attr({opacity:0});t.node.id=this.id,i.push(t),++a==h&&n(e,i,r)}var a=0,h=t.length,i=[];t.forEach(function(e,t){var r=new Image;r.onload=o,r.onerror=o,r.src=e,r.id="wheel_image_"+t})}function o(e,r,n){var o=[];g[g.length-(n+1)].forEach(function(r){var n=e.image(r.url,r.x,r.y,r.width,r.height).attr({opacity:1});t(n.node,"svg_group_addition"),o.push(n)});var h;switch(n){case 2:h=300;break;case 1:h=230;break;case 0:h=160}var l=(h-100)/h;l=(100*l|0)/100;var c=e.circle(800,500,h).attr({fill:"#000",stroke:"none"});c.node.style.transform="scale("+l+","+l+")",e.group([o[0]].concat(r,c,o[1]),"svg_group_"+n),a(e,r,n),_.push(r),n>0?p(e,n-1):(i(2),$(document).trigger("wheel/show"))}function a(t,n,o){var a=document.createElementNS(d,"clipPath");a.setAttribute("id","clip_ring"+o),a.appendChild(e(t,o).node),t.canvas.appendChild(a),n.forEach(function(e,t){var n=w*t;e.rotate(n,800,500),e.node.setAttribute("clip-path","url(#clip_ring"+o+")"),e.node.style.cursor="pointer",e.attr({opacity:0}),r(e,w,t)})}function h(e,t){e.forEach(function(e,r){e.animate({transform:"r"+((1==t?-360:360)+w*r)+",800,500"},3e4)}),t>0&&i(--t)}function i(e){var t=_[e],r=t.length;t.forEach(function(n,o){n.attr({opacity:1}).animate({transform:"r"+w*o+",800,500t0,0"},1e3,"<>",function(){o==r-1&&h(t,e)})})}function p(e,t){var r=10*t;n(e,c.slice(r,r+10),t,o)}var l="/bower/bridgeplus_ui/public/images/",c=["wheel/student_1.jpg","wheel/student_2.jpg","wheel/student_3.jpg","wheel/student_4.jpg","wheel/student_5.jpg","wheel/student_6.jpg","wheel/student_7.jpg","wheel/student_8.jpg","wheel/student_9.jpg","wheel/student_10.jpg","wheel/mentor_1.jpg","wheel/mentor_2.jpg","wheel/mentor_3.jpg","wheel/mentor_4.jpg","wheel/mentor_5.jpg","wheel/mentor_6.jpg","wheel/mentor_7.jpg","wheel/mentor_8.jpg","wheel/mentor_9.jpg","wheel/mentor_10.jpg","wheel/corporate_1.jpg","wheel/corporate_2.jpg","wheel/corporate_3.jpg","wheel/corporate_4.jpg","wheel/corporate_5.jpg","wheel/corporate_6.jpg","wheel/corporate_7.jpg","wheel/corporate_8.jpg","wheel/corporate_9.jpg","wheel/corporate_10.jpg"].map(function(e){return l+e}),g=[[{url:l+"CORPORATE_PG.png",width:460,height:102,x:600,y:120},{url:l+"CORPORATE.png",width:123,height:41,x:739,y:220}],[{url:l+"MENTOR_PG.png",width:245,height:183,x:677.5,y:110},{url:l+"MENTOR.png",width:123,height:41,x:739,y:290}],[{url:l+"STUDENT_PG.png",width:446,height:207,x:620,y:200},{url:l+"STUDENT.png",width:123,height:41,x:739,y:360}]],s=210,u=100,w=36,d="http://www.w3.org/2000/svg",_=[];Raphael.fn.group=function(e,r){var n=document.createElementNS("http://www.w3.org/2000/svg","g");if(t(n,"svg_group"),t(n,r),e)for(var o=0,a=e.length;o<a;o++)n.appendChild(e[o].node);return this.canvas.appendChild(n),n},Raphael.fn.wheel=function(){p(this,2)}}();