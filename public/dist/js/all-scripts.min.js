$(document).ready(function(){function e(){function e(){for(var e=$(".carousel .carousel-inner"),t=$(".carousel .item"),a=0,i=0;i<t.length;i++)a<$(t[i]).height()&&(a=$(t[i]).height());e.height(a+"px")}console.log("preparing my carousel...");var t=$("img[preload-src]").map(function(t,a){var i=$.Deferred(),n=$(a),s=new Image;return s.onload=function(){n.attr("src",s.src),e(),i.resolve(t)},s.src=n.attr("preload-src"),i});$.when.apply(null,t.get()).then(function(){});var a=$(".carousel .carousel-inner");a.height(a.height()+"px"),$(".carousel .item").each(function(){var e=$(this);e.css("width",e.closest(".carousel").width()+"px").css("float","left").css("position","absolute")}),$(".carousel .nav-bar .prev").click(function(){if(!i){i=!0;var e=$(this).closest(".carousel"),t=e.find(".item.active"),a=t.prev(".item");a.addClass("active").css("margin-left","-100%"),a.length<=0&&(a=e.find(".item").last(),a.addClass("active").css("margin-left","-200%")),t.animate({"margin-left":"100%"},function(){t.removeClass("active"),t.css("margin-left",0),a.animate({"margin-left":0},function(){i=!1})})}});var i=!1;$(".carousel .nav-bar .next").click(function(){if(!i){i=!0;var e=$(this).closest(".carousel"),t=e.find(".item.active"),a=t.next(".item");a.length<=0&&(a=e.find(".item:first-child")),a.addClass("active").css("margin-left","100%"),t.animate({"margin-left":"-100%"},function(){t.removeClass("active"),t.css("margin-left",0),a.animate({"margin-left":0},function(){i=!1})})}})}e(),$(document).on("pjax/done",function(){setTimeout(e,100)})});
!function(){function o(o,t){$(o).children().each(function(){var o=$(this);o.attr("data-group")&&o.attr("data-group")!==t?o.hide():o.show()})}function t(o){o.removeClass("show");var t=o.find("video");t.length&&t[0].pause()}$(document).on("show_content",function(t,n,s){o(".group-description",s),o(".carousel-items",s),o(".services",s)}).on("click",".mask .close.button",function(){t($(this).closest(".mask"))}).on("click",".mask .shadow-box",function(o){o.stopPropagation()}).on("click",".mask",function(){t($(this))}).on("keydown",function(o){27===o.keyCode&&t($(".mask.show"))}).on("click","[data-modal-selector]",function(o){$($(this).attr("data-modal-selector")).addClass("show"),o.stopPropagation()})}();
var vmvideos=[{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_1.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_2.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_3.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_4.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_5.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_6.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_7.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_8.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_9.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_10.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_11.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_12.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_13.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_14.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_15.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_16.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/corporate_17.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_1.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_2.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_3.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_4.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_5.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_6.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_7.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_8.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_9.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_10.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_11.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_12.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_13.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_14.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_15.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/mentor_16.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_1.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_2.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_3.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_4.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_5.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_6.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_7.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_8.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_9.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_10.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_11.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_12.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_13.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_14.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_15.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_16.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_17.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_18.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_19.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_20.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_21.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_22.jpg"},{thumb:"/bower/bridgeplus_ui/public/images/wheel/student_23.jpg"}],additionInfo=[[{url:"/bower/bridgeplus_ui/public/images/CORPORATE_PG.png",width:460,height:102,x:600,y:120},{url:"/bower/bridgeplus_ui/public/images/CORPORATE.png",width:123,height:41,x:739,y:220}],[{url:"/bower/bridgeplus_ui/public/images/MENTOR_PG.png",width:245,height:183,x:677.5,y:110},{url:"/bower/bridgeplus_ui/public/images/MENTOR.png",width:123,height:41,x:739,y:290}],[{url:"/bower/bridgeplus_ui/public/images/STUDENT_PG.png",width:446,height:207,x:620,y:200},{url:"/bower/bridgeplus_ui/public/images/STUDENT.png",width:123,height:41,x:739,y:360}]];
$(function(){function t(){s.currentW=$(window).width(),s.currentH=$(window).height(),r=.5*s.currentW,a=.5*s.currentH}function e(){var t=$("#bridge_plus_intro svg");if(t.length){var e=0|t.attr("height"),o="scale3d(1,"+s.currentH/e+",1)";t.css({"-webkit-transform":o,"-moz-transform":o,"-ms-transform":o,transform:o})}}function o(t){var e=[];return t.classList&&"function"==typeof t.classList.forEach?t.classList.forEach(function(t){e.push(t)}):e=(t.getAttribute("class")||"").split(" "),e}function n(){$(".owl-carousel").owlCarousel({items:1,lazyLoad:!0,loop:!0,autoplayTimeout:8e3,autoplayHoverPause:!0,nav:!0,navRewind:!0,smartSpeed:500,navText:["<i>&lt;</i>","<i>&gt;</i>"],autoHeight:!0})}function i(){g.height(m.height()-f-d),setTimeout(n,500)}var r,a,s={currentW:0,currentH:0};!function(){function t(){function t(){var e=i.clone().attr({r:c,opacity:0,fill:"none","stroke-width":1});e.attr({opacity:1}).animate({r:c+10,"stroke-width":41,stroke:"#FFF"},1e3,">",function(){}),c+=40,c<r+150?setTimeout(t,50):($("#logo").addClass("active"),$(".logo_top").addClass("active"),setTimeout(function(){BridgeWheel.start()},1e3))}var e=this.intro=new Raphael("bridge_plus_intro",s.currentW,s.currentH),n=e.path("M 0,"+s.currentH+" L 0,"+s.currentH).attr({fill:"#E71E30",stroke:"#E71E30","stroke-width":4}),i=e.circle(r,a,0).attr({fill:"#111",stroke:"#111"});n.animate({path:"M 0,"+s.currentH+" L "+r+","+a},1e3,">",function(){o.arcouno(),n.animate({path:"M "+r+","+a+"L "+r+","+a},1e3,">",function(){}),i.animate({r:"72"},1800,">",function(){}),setTimeout(t,1100)});var c=0}function e(){var t=o.intro.path(o.arc([r,a],120,120,320)).attr({stroke:"#111","stroke-width":1});t.attr({transform:"r0,"+r+","+a}).animate({transform:"r360,"+r+","+a},4e3)}var o=window.INTRO={intro:null,init:t,arcouno:e,arc:function(t,e,o,n){for(var i=o,r=this.toCoords(t,e,i),a="M "+r[0]+" "+r[1];n>=i;)r=this.toCoords(t,e,i),a+=" L "+r[0]+" "+r[1],i++;return a},toCoords:function(t,e,o){var n=o/180*Math.PI,i=t[0]+Math.cos(n)*e,r=t[1]+Math.sin(n)*e;return[i,r]}}}(),function(){var t=window.BridgeWheel={first:!0,sourceArr:[],imgAll:[],init:function(){this.first&&(this.first=!1,INTRO.init())},start:function(){t.resize(),$("#bridge_plus_wheel").addClass("active");var e=new Raphael("bridge_plus_wheel",1600,1e3);e.wheel(440,vmvideos.slice(7,17),2,vmvideos,[],additionInfo)},resize:e}}();var c=$(".wheel_text"),u=$(".main_page_wheel"),h=$(".main_page_bottom"),l=$(".main_page_right");$(document).on("wheel/show",function(){$(".svg_group").hover(function(){$(document).trigger("show_group_desc",o(this))},function(){$(document).trigger("hide_group_desc",o(this))}).on("click",function(){var t,e=o(this);e.indexOf("svg_group_0")>=0&&(t="/portal/zh/student-portal"),e.indexOf("svg_group_1")>=0&&(t="/portal/zh/mentor-portal"),e.indexOf("svg_group_2")>=0&&(t="/portal/zh/hr-portal"),$(document).trigger("navigate",t)})}).on("click",".logo_right",function(){$(document).trigger("show_right")}).on("show_group_desc",function(t,e,o){c.hide().each(function(){$(this).hasClass(o)&&$(this).show()})}).on("hide_group_desc",function(t,e,o){c.each(function(){$(this).hasClass(o)&&$(this).hide()})}).on("show_wheel",function(){u.animate({top:0,left:0},500),h.animate({top:"100%",left:0},500),l.animate({left:"100%"},500),BridgeWheel.init()}).on("show_content",function(){return"/"===location.pathname?void $(document).trigger("show_wheel"):(u.animate({top:"-100%",left:0},500),h.animate({top:0,left:0},500),l.animate({left:"100%"},500),void i())}).on("show_right",function(){u.animate({left:"-100%"},500),h.animate({left:"-100%"},500),l.animate({left:0},500)}).on("pjax/done",document,function(){$(document).trigger("show_content",null),setTimeout(n,100)});var f=$(".to-top").outerHeight(),d=$("#footer").outerHeight(),g=$(".body"),m=$("body");$(window).on("resize",function(){t(),BridgeWheel.resize(),i()}),t(),"/"==location.pathname?BridgeWheel.init():$(document).trigger("show_content")});
$(document).ready(function(){var e=!1;$(".menu-button").click(function(){e?$(".menu").removeClass("active"):$(".menu").addClass("active"),e=!e}),$(document).on("show_right",function(){$("#pic-entrance").addClass("active")}).on("show_wheel",function(){$("#pic-entrance").removeClass("active")}).on("click",".left-arrow",function(){$(document).trigger("show_wheel")})});
!function(){function t(t,n,e,o,i){if(d.indexOf(t)>=0&&d.indexOf(n)>=0)return o;var r=s.indexOf(t),a=s.indexOf(n);return r<0||a<0||r===a?e:r<a?o:i}function n(t){t.css({position:"absolute",left:"100%",right:"-100%"})}function e(t){t.animate({left:"-100%",right:"100%"},"slow",function(){t.remove()})}function o(t){return t.animate({left:"0",right:"0"},"slow",function(){t.css("position","relative")}).promise()}function i(t){t.css({position:"absolute",left:"-100%",right:"100%"})}function r(t){t.animate({left:"100%",right:"-100%"},"slow",function(){t.remove()})}function a(t,n){var e=document.createElement("div");e.innerHTML=t.innerHTML;var o=$(e),i=$(t);o.css({position:"absolute",left:"0",right:"0"}),o.insertBefore(i),n&&n(o,i)}function c(){$("#footer").css("position","fixed")}function u(){$("#footer").css("position","relative")}function l(t,i){c(),n(t),e(i),o(t).done(u)}function f(t,n){c(),i(t),r(n),o(t).done(u)}var s=["/portal/zh/about-us","/portal/zh/team","/portal/zh/video","/portal/zh/contact-us","/portal/zh/join-us"],d=["/portal/zh/student-portal","/portal/zh/mentor-portal","/portal/zh/hr-portal"];window.animationDirector={returnToOriginalPos:o,cloneOldSlide:a,getAnimation:t,slideToLeft:l,slideToRight:f}}(),$(function(){function t(t){p.push(t),p.length>5&&p.shift()}function n(t){m.push(t),m.length>5&&m.shift()}function e(t){g.push(t),g.length>5&&g.shift()}function o(t,n,e){r(n,e,function(){s.classList.add("hide"),setTimeout(function(){s.innerHTML=t,s.classList.remove("hide")},100)})}function i(){s=s||document.querySelector(".body"),d=d||document.querySelector("title")}function r(t,n,e){$(document).trigger("pjax/refresh"),i(),e(),c(n,t),$(document).trigger("pjax/done"),console.log("pjax/done")}function a(t,n,e){r(n,e,function(){animationDirector.cloneOldSlide(s,function(n,e){s.innerHTML=t,animationDirector.slideToLeft(e,n)})})}function c(t,n){Object.keys(t).forEach(function(n){s.setAttribute("data-"+n,t[n])}),d&&(d.innerHTML=n)}function u(t,n,e){r(n,e,function(){animationDirector.cloneOldSlide(s,function(n,e){s.innerHTML=t,v(e,n)})})}function l(t){for(var n={},e=t.length-1;e>=0;e--){var o=t[e];0==o.name.indexOf("data-")&&(n[o.name.slice(5)]=o.value)}return n}function f(i,r,a,c){$(document).trigger("pjax/start"),$.get(i,function(u){s=s||document.querySelector(".body"),d=d||document.querySelector("title"),h.innerHTML=u,a&&(history.pushState(i,"",i),t(s.innerHTML),n(l(s.attributes)),d&&e(d.innerHTML));var f=h.querySelector(".body"),p=h.querySelector("title");(c=c||o)(f.innerHTML,p&&p.innerHTML,l(f.attributes),r)})}var s,d,h=document.createElement("DIV"),p=[],m=[],g=[];document.addEventListener("click",function(t){var n=t.target;if("A"!==n.nodeName){if(n=$(n).closest("a"),!n.length)return!0;n=n[0]}var e=n.href?n.href.toLowerCase():"";return"false"===n.getAttribute("use-pjax")||!e.length||"#"==e.charAt(0)||0==e.indexOf("mailto:")||0==e.indexOf("javascript:")||(t.preventDefault(),t.stopPropagation(),void f(e,n,!0,animationDirector.getAnimation(location.pathname,n.pathname,o,a,u)))},!1),window.addEventListener("popstate",function(){return p&&p.length?void o(p.pop(),g.pop(),m.pop()):void f(location.href)}),$(document).on("navigate",function(t,n){f(n,null,!0)});var v=animationDirector.slideToRight});
Raphael.fn.group=function(t,a){var r=document.createElementNS("http://www.w3.org/2000/svg","g");if(r.style&&(r.style.webkitTapHighlightColor="rgba(0,0,0,0)"),r.classList)r.classList.add("svg_group"),r.classList.add(a);else{var n=(r.getAttribute("class")||"").split(" "),e=!1;n.indexOf("svg_group")==-1&&(n.push("svg_group"),e=!0),n.indexOf(a)==-1&&(n.push(a),e=!0),e&&r.setAttribute("class",n.join(" "))}if(t)for(var o=0,i=t.length;o<i;o++)r.appendChild(t[o].node);return this.canvas.appendChild(r),r},Raphael.fn.wheel=function(t,a,r,n,e,o){function i(){var t=g.image(this.src,690,y,E,L).attr({opacity:0});v.push(t),++m==d&&l()}function c(){var t=g.image("http://vlog.it/img/placeholder.jpg",690,y,E,L).attr({opacity:0});t.node.id=this.id,v.push(t),++m==d&&l()}function s(t,a){var r="M,800,500,L,862.3735072453278,206.5557197798583,A,300,300,0,0,0,737.6264927546722,206.5557197798583,z",r="M,800,500,L,855.1248553449711, 205.1080700948295,A,300,300,0,0,0,744.8751446550289, 205.1080700948295,z",r="M,800,500,L,892.7050983124842, 214.68304511145396,A,300,300,0,0,0,707.2949016875158, 214.68304511145396,z",n="M,800,500,L,844.8707740637095,274.419385507257,A,230,230,0,0,0,755.1292259362905,274.419385507257,z",n="M,800,500,L,871.073908706238, 281.2570012521147,A,230,230,0,0,0,728.926091293762, 281.2570012521147,z",e="M,800,500,L,835.6033494330103,344.0115340509082,A,160,160,0,0,0,764.3966505669897,344.0115340509082,z",e="M,800,500,L,849.4427190999916, 347.8309573927754,A,160,160,0,0,0,750.5572809000084, 347.8309573927754,z",o=[g.path(e).attr({stroke:"none"}),g.path(n).attr({stroke:"none"}),g.path(r).attr({stroke:"none"})],i=document.createElementNS(A,"clipPath");i.setAttribute("id","clip_ring"+t),i.appendChild(o[t].node),g.canvas.appendChild(i),a.forEach(function(a,r){var n=w*r;a.rotate(n,800,500),a.node.setAttribute("clip-path","url(#clip_ring"+t+")"),a.node.style.cursor="pointer",a.attr({opacity:0}),h(a,w,r)})}function h(t,a,r){t.attr({transform:"r"+a*r+",800,500t0,140"})}function l(){var t=[];o[o.length-(r+1)].forEach(function(a){var r=g.image(a.url,a.x,a.y,a.width,a.height).attr({opacity:1});r.node.classList.add("svg_group_addtion"),t.push(r)});var a;switch(r){case 2:a=300;break;case 1:a=230;break;case 0:a=160}var i=(a-100)/a;i=(100*i|0)/100;var c=g.circle(800,500,a).attr({fill:"#000",stroke:"none"});c.node.style.transform="scale("+i+","+i+")",g.group([t[0]].concat(v,c,t[1]),"svg_group_"+r),s(r,v),e.push(v),2==r?g.wheel(340,n.slice(17,27),1,n,e,o):1==r?g.wheel(240,n.slice(34,44),0,n,e,o):(u(),$(document).trigger("wheel/show"))}function u(){var t=36,a=e[2],r=a.length;a.forEach(function(n,e){e==r-1?n.attr({opacity:1}).animate({transform:"r"+t*e+",800,500t0,0"},1e3,"<>",function(){f(),a.forEach(function(a,r){a.animate({transform:"r"+(360+t*r)+",800,500"},3e4)})}):n.attr({opacity:1}).animate({transform:"r"+t*e+",800,500t0,0"},1e3,"<>",function(){})})}function f(){var t=36,a=e[1],r=a.length;a.forEach(function(n,e){n.attr({opacity:1}).animate({transform:"r"+t*e+",800,500t0,0"},1e3,"<>",function(){e==r-1&&(p(),a.forEach(function(a,r){a.animate({transform:"r"+(-360+t*r)+",800,500"},3e4)}))})})}function p(){var t=e[0],a=t.length,r=36;t.forEach(function(n,e){n.attr({opacity:1}).animate({transform:"r"+r*e+",800,500t0,0"},1e3,"<",function(){e==a-1&&t.forEach(function(t,a){t.animate({transform:"r"+(360+r*a)+",800,500"},3e4)})})})}var g=this,d=a.length,m=0,v=[],w=360/d,y=340-70*r,A="http://www.w3.org/2000/svg",E=210,L=100;a.forEach(function(t){var a=new Image;a.onload=i,a.onerror=c,a.src=t.thumb,a.id=t.url,a.title=t.title,a.author=t.author})};